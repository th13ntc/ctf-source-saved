<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Edit User">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Edit User</title>
    <link rel="stylesheet" href="/css/nicepage.css" media="screen">
<link rel="stylesheet" href="/css/Edit-User.css" media="screen">
    <script class="u-script" type="text/javascript" src="/js/jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="/js/nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 3.8.0, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster:400">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"url": "index.html"
}</script>
    <meta property="og:title" content="Edit User">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#478ac9">
    <link rel="canonical" href="index.html">
    <meta property="og:url" content="index.html">
  </head>
  <body class="u-body">
  <div th:insert="_menu"/>
    <section class="u-align-center u-clearfix u-section-1" id="carousel_b6ec">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width-md u-expanded-width-sm u-expanded-width-xs u-gutter-0 u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-image u-layout-cell u-left-cell u-size-30 u-image-1" th:style="'background-image: url(/getImage?name=' + ${user.getAvt()}+');'">
                <div class="u-container-layout u-container-layout-1"></div>
              </div>
              <div class="u-container-style u-layout-cell u-right-cell u-shape-rectangle u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-valign-bottom u-container-layout-2">
                  <h2 class="u-align-center u-text u-text-1">Edit User</h2>
                  <div class="u-form u-form-1">
                      <form id="update" class="u-clearfix u-form-spacing-40 u-form-vertical u-inner-form" style="padding: 0px;" source="custom" >
                          <div class="u-form-email u-form-group">
                              <label for="userName" class="u-label u-text-palette-2-base u-label-1">User Name</label>
                              <input type="text" placeholder="User Name" th:value="${user.getUser_name()}" id="userName" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" required="">
                          </div>
                          <div class="u-form-email u-form-group">
                              <label for="name" class="u-label u-text-palette-2-base u-label-1">Full Name</label>
                              <input type="text" placeholder="Enter a valid full name" id="name" th:value="${user.getName()}" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" required="">
                          </div>
                          <div class="u-form-email u-form-group">
                              <label for="email" class="u-label u-text-palette-2-base u-label-1">Email</label>
                              <input type="email" placeholder="Enter a valid email address" id="email" th:value="${user.getEmail()}" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" required="">
                          </div>
                          <div class="u-form-email u-form-group">
                              <label for="age" class="u-label u-text-palette-2-base u-label-1">Age</label>
                              <input type="number" min="10" placeholder="Enter a valid age" id="age" th:value="${user.getAge()}" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" required="">
                          </div>
                          <div class="u-form-email u-form-group">
                              <label for="wallet" class="u-label u-text-palette-2-base u-label-1">Wallet</label>
                              <input type="number" placeholder="wallet" id="wallet" th:value="${user.getWallet()}" min="0" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" required="">
                          </div>
                          <div class="u-form-group u-form-select u-form-group-3">
                              <label for="role" class="u-label u-text-palette-2-base u-label-3">Role</label>
                              <div class="u-form-select-wrapper">
                                  <select id="role" name="select" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle">
                                      <option th:value="${user.getRole()}" selected="" disabled="" hidden="">Choose here</option>
                                      <option value="ROLE_USER">user</option>
                                      <option value="ROLE_ADMIN">admin</option>
                                  </select>
                                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="12" version="1" class="u-caret"><path fill="currentColor" d="M4 8L0 4h8z"></path></svg>
                              </div>
                          </div>
                          <div class="u-form-email u-form-group">
                              <label for="pass" class="u-label u-text-palette-2-base u-label-1">Password</label>
                              <input type="password" placeholder="Password" id="pass" class="u-border-4 u-border-black u-border-no-left u-border-no-right u-border-no-top u-input u-input-rectangle" >
                          </div>
                          <div class="u-form-agree u-form-group u-form-group-4">
                              <input type="checkbox" id="enabled" class="u-agree-checkbox" th:checked="${user.getEnabled()}">
                              <label for="enabled" class="u-label u-text-palette-2-base u-label-4"> Enabled
                              </label>
                          </div>
                          <i><p id="msg" class="u-label u-text-palette-2-base u-label-4" th:text="${msg}" th:if="${msg ne null}"/></i>

                      </form>
                  </div>
                  <button type="button" class="u-btn u-button-style u-btn-2" onclick="sendJSON()">Update</button>
                  <button form="deleteUser" class="u-btn u-button-style u-btn-3"  >Delete</button>
                    <form id="deleteUser" method="post" action="/admin/deleteUser">
                        <input type="hidden" name="id" th:value="${user.getId_user()}" >
                    </form>
                  <button type="button" onclick="checkAVT()" class="u-btn u-button-style u-btn-4">Check AVT</button>

                    <script class="u-script" th:inline="javascript">
    function sendJSON(){

            let userName = document.querySelector('#userName');
            let name = document.querySelector('#name');
            let email = document.querySelector('#email');
            let age = document.querySelector('#age');
            let pass = document.querySelector('#pass');
            let wallet = document.querySelector('#wallet');
            let role = document.querySelector('#role');
            var enabled = document.getElementById("enabled").checked;

            // Creating a XHR object
            let xhr = new XMLHttpRequest();
            let url = "/admin/editUser";

            // open a connection
            xhr.open("POST", url, true);

            // Set the request header i.e. which type of content you are sending
            xhr.setRequestHeader("Content-Type", "application/json");

            // Create a state change callback
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {

                    // Print received data from server
                    location.replace(this.responseText);

                }
                else {
                    document.getElementById("msg").innerHTML = "Error: Hay thuc hien lai hanh dong";
                }
            };

            // Converting JSON data to string
            var data = JSON.stringify({ "user_name": userName.value,
                                        "name": name.value,
                                        "email": email.value,
                                        "age": age.value,
                                        "password": pass.value,
                                        "wallet": wallet.value,
                                        "role": role.value,
                                        "enabled": enabled});

            // Sending data with the request
            xhr.send(data);
    };

    function checkAVT() {
        var name =   /*[[${user.getAvt()}]]*/;

        let xhr = new XMLHttpRequest();
        let url = "/admin/checkAVTVuln";
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {

                    // Print received data from server
                    document.getElementById("msg").innerHTML = this.responseText;

                }
                else {
                    document.getElementById("msg").innerHTML = "Error: Hay thuc hien lai hanh dong";
                }
            };

        xhr.send("name="+name);

    }
</script>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-8413"><div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Sample text. Click to select the text box. Click again or double click to start editing the text.</p>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/html-templates" target="_blank">
        <span>HTML Template</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="https://nicepage.com/static-site-generator" target="_blank">
        <span>Static Site Generator</span>
      </a>. 
    </section>
  </body>
</html>